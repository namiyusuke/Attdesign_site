---
import { client,type Category  } from '../../lib/microcms';
import kumin from "@assets/img/kuu-icon.png";
import frame from "@assets/img/photo-frame.png";
import frameSp from "@assets/img/photo-frame-sp.png";
import x_logo from "@assets/img/x_logo.png";
import menuBack from "@assets/img/menuBack.png";
import menuBack2 from "@assets/img/menuBack2.png";
import menuBack3 from "@assets/img/menuBack3.png";
import menuBack4 from "@assets/img/menuBack4.png";
// microCMSからcategoryデータを取得
const categoryResponse = await client.getList<Category>({
  endpoint: 'category',
  queries: { limit: 100 },
});

const categories = categoryResponse.contents;


---


  <div class="header">
    <p class="header-icon">
      <img src={kumin.src} alt="">
    </p>
    <p class="header-icon-filter">View</p>
  </div>
  <div class="menu">
    <div class="menu-inner">
      <img class="menu-back" src={menuBack.src} alt="" data-images={JSON.stringify([menuBack.src, menuBack2.src, menuBack3.src, menuBack4.src])}>
      <picture class="menu-frame">
        <source srcset={frameSp.src} media="(max-width: 767px)" />
        <img src={frame.src} alt="" />
      </picture>
      <span class="menu-close"></span>
      <div class="menu-text-top">
        <p>一瞬の空気感を切り取れるような1枚を目指して、写真の練習に励んでいます。</p>
        <p>『Photoire』＝写真で残す日々の記録です。</p>
      </div>
      <div class="menu-text-bottom">
        <p class="menu-text-bottom-jp">Kumi Kaneko<br>金子 久美</p>
        <p class="menu-text-bottom-en">Web design/Graphic design/<br>Direction support</p>
      </div>
      <div class="menu-text-btn">
        <p class="menu-btn-x">
          <a target="_blank" href="https://x.com/kuumin_design">
            <img src={x_logo.src} alt="">
          </a>
        </p>
        <p class="menu-btn-contact">
          <a target="_blank" href="mailto:kumi_kaneko@attdesign.site">お問い合わせ</a>
        </p>
      </div>
    </div>
  </div>
  <div class="menu-filter">
    <div class="menu-filter-inner">
      <span class="menu-close"></span>
      <ul>
         <li><a href="/">top</a></li>
        {categories.map((cat) => (
          <li>
            <a href={`/photo/?category=${cat.data}`}>{cat.data}</a>
          </li>
        ))}
        <li> <a href={`/photo/`}>daily</a></li>
      </ul>
    </div>
  </div>
  <style is:global>
    .menu-back{
      position: absolute;
      inset: 0;
      margin: auto;
      display: grid;
      place-items: center;
      width: 75%;
      pointer-events: none;
    }
    .menu-text-btn{
      display: flex;
      column-gap: calc(24 / 16 * 1rem);
      margin-top: calc(60 / 16 * 1rem);
      position: relative;
      z-index: 10;
    }
     @media (min-width:768px) {
      .menu-text-btn{
        display: flex;
        column-gap: calc(24 / 16 * 1rem);
        margin-top: calc(60 / 1440 * 100cqw);
        position: relative;
        z-index: 10;
      }
     }
   .menu-text-btn a{
    border-radius:calc(8 / 16 * 1rem);
    background-color: #202020;
    color:#fff;
    display:block;
    line-height: 1;
    transition: transform .4s ease;
  }
   .menu-text-btn a:hover{
    transform: scale(1.1);
   }
    .menu-btn-x a{
      padding:calc(8 / 16 * 1rem);
    }
    .menu-btn-x img{
      width: calc(14 / 16 * 1rem);
    }
    .menu-btn-contact a{
      padding-block:calc(10 / 16 * 1rem);
      padding-inline:calc(12 / 16 * 1rem);
      font-size: calc(14 / 16 * 1rem);
    }
    .menu-close{
      width: calc(20 / 16 * 1rem) ;
      height: calc(20 / 16 * 1rem) ;
      position: absolute;
      top: calc(24 / 16 * 1rem) ;
      right: calc(24 / 16 * 1rem) ;
      cursor: pointer;
    }
    .menu-close::after,
    .menu-close::before{
      position: absolute;
      margin: auto;
      content: "";
      width: 100%;
      height: 1px;
      background-color: #202020;
    }
    .menu-filter-inner .menu-close::after,
    .menu-filter-inner .menu-close::before{
      background-color: #fff;
    }
    .menu-close::after{
      transform: rotate(45deg);
    }
    .menu-close::before{
      transform: rotate(-45deg);
    }
    .header-icon-filter{
      cursor: pointer;
      line-height: 1;
      background-color:#202020 ;
      color: #fff;
      padding-block: calc(8 / 16 * 1rem);
      padding-inline: 1rem;
      font-size: calc(14 / 16 * 1rem);
      font-family: var(--ff-jp2);
      font-weight: 700;
      letter-spacing: .16em;
      transition: color .4s ease,background-color .4s ease;
    }
    @media (min-width:768px) {
      .header-icon-filter{
        padding-block: calc(12 / 16 * 1rem);
      }
    }
  .header-icon-filter:hover{
      background-color: #fff;
      color: #202020;
   }
    .header{
      position: fixed;
      top: calc(32 / 16 * 1rem) ;
      right: calc(23 / 16 * 1rem) ;
      z-index: 100;
      display: flex;
      align-items: center;
      flex-direction: row-reverse;
      column-gap: calc(24 / 16 * 1rem) ;
    }
    @media (min-width:768px) {
      .header{
        position: fixed;
        top: calc(54 / 16 * 1rem) ;
        right: calc(48 / 16 * 1rem) ;
        z-index: 100;
        display: flex;
        align-items: center;
        flex-direction: row-reverse;
        column-gap: calc(24 / 16 * 1rem) ;
      }
    }
    .header-icon{
      width: calc(40 / 16 * 1rem);
      cursor: pointer;
    }
    .menu{
      position: fixed;
      top: calc(60 / 16 * 1rem);
      right: 8px;
      width: calc(300 / 375 * 100cqw);
      height: max-content;
      aspect-ratio:300/537 ;
      color: #222;
      z-index: 10;
      opacity: 0;
      transform: translate(200px, -300%) rotate(-15deg);
      pointer-events: none;
      transition: opacity 0.4s ease-out, transform 1.4s cubic-bezier(0.16, 1, 0.3, 1);
      cursor: grab;
      background-color: #fff;
      font-family: var(--ff-jp2);
      font-weight: 700;
    }
    @media (min-width:768px) {
      .menu{
        top: calc(100 / 16 * 1rem);
        right: calc(48 / 16 * 1rem);
        width: calc(448 / 1440 * 100cqw);
        aspect-ratio:448/537 ;
      }
    }
    .menu-frame{
      position: absolute;
      inset: 0;
      margin: auto;
      width: calc(260 / 375 * 100cqw);
      display: grid;
      place-items: center;
    }
    @media (min-width:768px) {
      .menu-frame{
        position: absolute;
        inset: 0;
        bottom: 10%;
        margin: auto;
        width: calc(400 / 1440 * 100cqw);
      }
    }
    .menu.is-active{
      opacity: 1;
      transform: translate(0, 0) rotate(3deg);
      pointer-events: auto;
    }
    .menu.is-dragging{
      cursor: grabbing;
      transition: none;
    }
    .menu-inner{
      padding-block:calc(80 / 16 * 1rem);
      padding-inline:calc(40 / 16 * 1rem);
      font-weight: bold;
      height: 100%;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      position: relative;
    }
    @media (min-width:768px) {
      .menu-inner{
        padding:calc(80 / 16 * 1rem);
      }
    }
    .menu-text-top{
      font-size: 1rem;
    }
      @media (min-width:768px) {
        .menu-text-top{
          font-size: calc(16 / 1440 * 100cqw);
        }
      }
    .menu-text-top p + p{
      margin-top: calc(16 / 16 * 1rem);
    }
    .menu-text-bottom{
      text-align: center;
      margin-top: calc(60 / 16 * 1rem);
      font-size:  calc(14 / 16 * 1rem);
    }
      @media (min-width:768px) {
        .menu-text-bottom{
      text-align: center;
      margin-top: calc(60 / 1440 * 100cqw);
      font-size:  calc(14 / 16 * 1rem);
    }
      }
    .menu-text-bottom-en{
      font-size: calc(12 / 16 * 1rem);
    }
     @media (min-width:768px) {
    .menu-text-bottom{
      text-align: center;
      margin-top: calc(60 / 1440 * 100cqw);
      font-size: calc(14 / 1440 * 100cqw);
    }
    .menu-text-bottom-en{
      font-size: calc(14 / 16 * 1rem);
    }
     }
    .menu-text-bottom p + p{
      margin-top: calc(16 / 16 * 1rem);
    }
    .menu-filter{
      position: fixed;
      top: 100px;
      right: 48px;
      width: 230px;
      color: #222;
      z-index: 10;
      opacity: 0;
      transform: translate(200px, -300%) rotate(-15deg);
      pointer-events: none;
      transition: opacity 0.4s ease-out, transform 1.4s cubic-bezier(0.16, 1, 0.3, 1);
      cursor: grab;
      font-family: var(--ff-jp2);
      font-weight: 700;

    }
    .menu-filter.is-active{
      opacity: 1;
      transform: translate(0, 0) rotate(3deg);
      pointer-events: auto;
    }
    .menu-filter.is-dragging{
      cursor: grabbing;
      transition: none;
    }
    .menu-filter-inner{
      padding-block: calc(80 / 16 * 1rem);
      padding-inline: calc(43 / 16 * 1rem);
      background-color: rgba(32, 32, 32, .9);
      text-align: center;
    }
    .menu-filter-inner a{
      color: #fff;
      display: block;
      transition: transform .4s ease;
    }
    .menu-filter-inner a:hover{
      transform: scale(1.2);
    }
    .menu-filter-inner ul{
      list-style: none;
      width: max-content;
      margin-inline: auto;
    }
      .menu-filter-inner li {
        line-height: 1;
      }
    .menu-filter-inner li +li{
      margin-top: calc(24 / 16 * 1rem);
    }
    a.current{
      opacity: .4;
    }
  </style>
<script>
  import { initMenuController } from '../../assets/js/libs/MenuController';
  if (document.readyState === 'loading') {
    document.addEventListener('DOMContentLoaded', () => initMenuController());
  } else {
    initMenuController();
  }

  // フィルターメニューのcurrentクラス付与
  const currentCategory = new URLSearchParams(window.location.search).get('category');
  const filterLinks = document.querySelectorAll('.menu-filter-inner a');
  filterLinks.forEach((link) => {
    const href = link.getAttribute('href') || '';
    const linkCategory = new URLSearchParams(href.split('?')[1] || '').get('category');
    if (currentCategory && linkCategory === currentCategory) {
      link.classList.add('current');
    } else if (!currentCategory && href === '/photo/') {
      link.classList.add('current');
    }
  });
</script>
